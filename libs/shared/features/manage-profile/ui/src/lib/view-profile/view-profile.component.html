<main class="flex flex-col w-full" *ngIf="me$ | async as my; else loading" [formGroup]="form">
  <label>Full name</label>
  <h2 class="font-bold my-0">{{ my.firstName }} {{ my.lastName }}</h2>
  <div class="p-4 border border-gray-900">
    <div class="relative w-40">
      <adc-frontend-avatar
        [url]="(form.value.avatarImage | dataUrl | async) || my.avatar"
        placeholderClass="!text-primary"
        size="xxl"
      ></adc-frontend-avatar>
      <input
        type="file"
        accept="image/*"
        class="hidden"
        (change)="clickChangeAvatar$.next($event)"
        #inputAvatar
      />
      <tui-marker-icon
        [mode]="MARKER_LINK"
        src="tuiIconUpload"
        size="s"
        class="bottom-right border border-solid border-primary"
        (click)="inputAvatar.click()"
      ></tui-marker-icon>
    </div>
  </div>
  <label>Email</label>
  <h3 class="font-bold mt-0">{{ my.email }}</h3>
  <label>Role</label>
  <h3 class="font-bold mt-0">{{ my.role }}</h3>
  <label>Phone</label>
  <tui-input-phone
    tuiTextfieldSize="m"
    [tuiTextfieldCleaner]="true"
    [tuiTextfieldLabelOutside]="true"
    countryCode="+84"
    phoneMaskAfterCountryCode="### ###-###"
    tuiTextfieldExampleText="+84 123 123-123"
    formControlName="phone"
    class="w-full mb-3 font-bold"
  >
  </tui-input-phone>
  <ng-container *ngIf="my.role === 'Staff'">
    <label>Managed by</label>
    <h3 class="font-bold mt-0">
      <ng-container *ngIf="my.managedBy; else notHasManagedBy">
        {{ my.managedBy?.firstName }} {{ my.managedBy?.lastName }}
      </ng-container>
      <ng-template #notHasManagedBy> None </ng-template>
    </h3>
  </ng-container>

  <button
    tuiButton
    size="m"
    appearance="outline"
    type="button"
    (click)="clickUpdate$.next()"
    class="w-full mb-3 primary"
  >
    Update Profile
  </button>
  <button
    tuiButton
    size="m"
    appearance="outline"
    type="button"
    routerLink="change-password"
    class="w-full danger mb-3"
  >
    Change Password
  </button>
  <button
    tuiButton
    size="m"
    appearance="outline"
    type="button"
    (click)="clickLogout$.next()"
    class="w-full danger"
  >
    Log out
  </button>
</main>
<ng-template #loading>
  <div class="h-full flex justify-center items-center"><tui-loader></tui-loader></div>
</ng-template>
